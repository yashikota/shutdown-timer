<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="shutdown_timer.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Title Bar -->
        <Border Grid.Row="0"
                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                BorderThickness="0,0,0,1"
                Padding="24,16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="12">
                    <FontIcon FontFamily="Segoe Fluent Icons"
                             Glyph="&#xE916;"
                             FontSize="20"
                             Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                    <TextBlock x:Name="HeaderText"
                             Text="Shutdown Timer"
                             FontSize="20"
                             FontWeight="SemiBold"
                             VerticalAlignment="Center"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                    <Button
                        Style="{StaticResource SubtleButtonStyle}"
                            ToolTipService.ToolTip="Settings"
                            Click="SettingsButton_Click">
                        <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE713;" FontSize="16"/>
                    </Button>
                    <Button
                        Style="{StaticResource SubtleButtonStyle}"
                            ToolTipService.ToolTip="About"
                            Click="InfoButton_Click">
                        <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE946;" FontSize="16"/>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Main Content -->
        <ScrollViewer Grid.Row="1"
                      VerticalScrollBarVisibility="Auto"
                      Padding="24">
            <StackPanel Spacing="24" MaxWidth="600">


                <!-- Timer Configuration -->
                <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="8"
                        Padding="20">
                    <StackPanel Spacing="20">

                                                <!-- Mode Selection -->
                        <StackPanel Spacing="16">
                            <SelectorBar x:Name="ModeSelectorBar"
                                        SelectionChanged="ModeSelectorBar_SelectionChanged"
                                        SelectedItem="{x:Bind DurationSelectorItem}">
                                <SelectorBarItem x:Name="DurationSelectorItem" Text="Duration"/>
                                <SelectorBarItem x:Name="SpecificTimeSelectorItem" Text="Specific Time"/>
                            </SelectorBar>

                            <!-- Duration Mode Content -->
                            <StackPanel x:Name="DurationModeContent" Spacing="16" Visibility="Visible">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <NumberBox x:Name="HoursInput"
                                             Grid.Column="0"
                                             Header="Hours"
                                             Value="0"
                                             SpinButtonPlacementMode="Compact"
                                             Maximum="23"
                                             Minimum="0"
                                             Margin="0,0,8,0"
                                             ValueChanged="TimeInput_ValueChanged"/>

                                    <NumberBox x:Name="MinutesInput"
                                             Grid.Column="1"
                                             Header="Minutes"
                                             Value="30"
                                             SpinButtonPlacementMode="Compact"
                                             Maximum="59"
                                             Minimum="0"
                                             Margin="8,0,8,0"
                                             ValueChanged="TimeInput_ValueChanged"/>

                                    <NumberBox x:Name="SecondsInput"
                                             Grid.Column="2"
                                             Header="Seconds"
                                             Value="0"
                                             SpinButtonPlacementMode="Compact"
                                             Maximum="59"
                                             Minimum="0"
                                             Margin="8,0,0,0"
                                             ValueChanged="TimeInput_ValueChanged"/>
                                </Grid>

                                <TextBlock x:Name="DurationPreview"
                                         Text="30分後 (00:30) にシャットダウンします"
                                         FontSize="14"
                                         Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                         HorizontalAlignment="Center"/>
                            </StackPanel>

                            <!-- Specific Time Mode Content -->
                            <StackPanel x:Name="SpecificTimeModeContent" Spacing="16" Visibility="Collapsed">
                                <TimePicker x:Name="ShutdownTimePicker"
                                           Header="Shutdown Time"
                                           SelectedTime="00:00"
                                           ClockIdentifier="24HourClock"
                                           HorizontalAlignment="Center"
                                           SelectedTimeChanged="ShutdownTimePicker_SelectedTimeChanged"/>

                                <TextBlock x:Name="TimePreview"
                                         Text="今日の0:00にシャットダウンします"
                                         FontSize="14"
                                         Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                         HorizontalAlignment="Center"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Action Options -->
                        <StackPanel Spacing="12">
                            <TextBlock x:Name="ActionOptionsHeader"
                                     Text="Action Options"
                                     FontWeight="SemiBold"
                                     FontSize="14"/>
                            <RadioButtons x:Name="ActionTypeRadio" SelectedIndex="0">
                                <RadioButton Content="Shutdown" Tag="shutdown"/>
                                <RadioButton Content="Restart" Tag="restart"/>
                            </RadioButtons>
                        </StackPanel>

                        <!-- Force Shutdown Option -->
                        <CheckBox x:Name="ForceShutdownCheck"
                                  Content="Force shutdown (unsaved data will be lost)"/>
                    </StackPanel>
                </Border>

                <!-- Control Buttons -->
                <StackPanel Orientation="Horizontal"
                            HorizontalAlignment="Center"
                            Spacing="12">
                    <Button x:Name="StartButton"
                            Click="StartButton_Click"
                            Style="{StaticResource AccentButtonStyle}"
                            MinWidth="120">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon x:Name="StartButtonIcon"
                                    FontFamily="Segoe Fluent Icons"
                                    Glyph="&#xE768;"/>
                            <TextBlock x:Name="StartButtonText" Text="Start"/>
                        </StackPanel>
                    </Button>

                    <Button x:Name="CancelButton"
                            Click="CancelButton_Click"
                            IsEnabled="False"
                            MinWidth="120">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE711;"/>
                            <TextBlock x:Name="CancelButtonText" Text="Cancel"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </StackPanel>
        </ScrollViewer>

        <!-- Status Bar -->
        <Border Grid.Row="2"
                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                BorderThickness="0,1,0,0"
                Padding="24,12">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Status Message -->
                <TextBlock x:Name="StatusText"
                          Grid.Column="0"
                          Text="Ready"
                          FontSize="14"
                          VerticalAlignment="Center"/>

                <!-- Countdown Display -->
                <StackPanel x:Name="CountdownPanel"
                           Grid.Column="1"
                           Orientation="Horizontal"
                           Spacing="6"
                           VerticalAlignment="Center"
                           Visibility="Collapsed">
                    <FontIcon FontFamily="Segoe Fluent Icons"
                             Glyph="&#xE916;"
                             FontSize="14"
                             Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                             VerticalAlignment="Bottom"
                             Margin="0,0,0,1"/>
                    <TextBlock x:Name="CountdownDisplay"
                              FontSize="14"
                              FontWeight="SemiBold"
                              Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                              VerticalAlignment="Bottom"/>
                    <FontIcon FontFamily="Segoe Fluent Icons"
                             Glyph="&#xE121;"
                             FontSize="14"
                             Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                             VerticalAlignment="Bottom"
                             Margin="12,0,0,1"/>
                    <TextBlock x:Name="TargetTimeDisplay"
                              FontSize="14"
                              FontWeight="SemiBold"
                              Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                              VerticalAlignment="Bottom"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
